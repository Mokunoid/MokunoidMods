<?xml version="1.0" encoding="utf-8" ?>
<Patch>
<Operation Class="XmlExtensions.UseSetting">
    <modId>MO_AnimalProductOptions</modId>
    <key>APO_MilkType</key>
    <defaultValue>1</defaultValue>
    <apply>
         <Operation Class="XmlExtensions.IfStatement"> 
        <condition Class="XmlExtensions.Boolean.Comparison"> 
          <value1>{APO_MilkType}</value1>
          <value2>4</value2>
          <nonNumeric>false</nonNumeric> 
        </condition>
		 <caseTrue>
		 <Operation Class="XmlExtensions.ForEach">
    <xpath>Defs/ThingDef//*[milkDef="Milk"]/ancestor::ThingDef</xpath>
    <storeIn>DEF</storeIn>
    <apply> 
	<Operation Class="XmlExtensions.CreateVariable">
    <storeIn>label</storeIn>
    <value>{DEF}/label</value>
    <fromXml>true</fromXml>
    <apply>
        <!--Patch operations here-->
		<Operation Class="XmlExtensions.Log">
	 <text>{label} milk found!</text>
		</Operation>
		<!--create unique milk-->
	   <Operation Class="PatchOperationInsert">   
		<xpath>/Defs/ThingDef[defName="Milk"]</xpath>
		<value>
		<ThingDef ParentName="OrganicProductBase">
    <defName>APO_Milk_Unique_{label}</defName>
    <label>{label} Milk</label>
    <description>Milk from a {label}.</description>
    <graphicData>
      <texPath>Things/Item/Resource/Milk</texPath>
    </graphicData>
    <socialPropernessMatters>true</socialPropernessMatters>
    <statBases>
      <MarketValue>4.0</MarketValue>
      <Mass>0.045</Mass>
      <MaxHitPoints>60</MaxHitPoints>
      <Flammability>0.2</Flammability>
      <Nutrition>0.06</Nutrition>
      <FoodPoisonChanceFixedHuman>0.02</FoodPoisonChanceFixedHuman>
    </statBases>
    <comps>
      <li Class="CompProperties_Rottable">
        <daysToRotStart>14</daysToRotStart>
        <rotDestroys>true</rotDestroys>
      </li>
    </comps>
    <ingestible>
      <preferability>RawTasty</preferability>
      <foodType>AnimalProduct, Fluid</foodType>
    </ingestible>
    <thingCategories>
      <li>AnimalProductRaw</li>
    </thingCategories>
  </ThingDef>
		</value>
		</Operation> 
		</apply>
		</Operation>
    </apply>
</Operation>

		 </caseTrue>
		 </Operation>
		 </apply>
		<!--use setting--> </Operation>
</Patch>